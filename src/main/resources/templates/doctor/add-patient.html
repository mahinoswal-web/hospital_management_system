<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Patient Form - MediPortal</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css" rel="stylesheet">
    <style>
        body { 
            background-color: #f0f4f8; 
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            overflow-x: hidden; 
        }
        
        /* Premium Gradient Sidebar (Matching Dashboard) */
        #sidebar { 
            min-height: 100vh; 
            background: linear-gradient(135deg, #1e3c72 0%, #2a5298 100%);
            color: white; 
            box-shadow: 4px 0 10px rgba(0,0,0,0.1);
        }
        #sidebar .nav-link { color: rgba(255,255,255,0.8); margin-bottom: 8px; border-radius: 10px; transition: all 0.3s ease; }
        #sidebar .nav-link:hover { background-color: rgba(255,255,255,0.2); color: white; transform: translateX(5px); }

        /* Form Styling */
        .glass-card { 
            background: #ffffff; 
            border: none; 
            box-shadow: 0 8px 30px rgba(0,0,0,0.05); 
            border-radius: 15px; 
            overflow: hidden;
        }
        .form-section-title {
            color: #2a5298;
            font-weight: 600;
            border-bottom: 2px solid #e0e6ed;
            padding-bottom: 0.5rem;
            margin-bottom: 1.5rem;
            margin-top: 1rem;
        }
        .form-control:focus, .form-select:focus {
            border-color: #2a5298;
            box-shadow: 0 0 0 0.25rem rgba(42, 82, 152, 0.15);
        }
    </style>
</head>
<body>

<div class="d-flex">
    <div class="d-flex flex-column p-4" id="sidebar" style="width: 280px; position: fixed; height: 100vh; z-index: 1000;">
        <a href="/doctor/docdashboard" class="d-flex align-items-center mb-4 text-white text-decoration-none">
            <div class="bg-white text-primary rounded-circle p-2 me-3 shadow-sm">
                <i class="bi bi-heart-pulse-fill fs-3"></i>
            </div>
            <span class="fs-4 fw-bold">MediPortal</span>
        </a>
        <hr class="text-white-50">
        <ul class="nav nav-pills flex-column mb-auto mt-2">
            <li><a href="/doctor/docdashboard" class="nav-link px-3 py-2"><i class="bi bi-grid-1x2-fill me-2"></i> Dashboard</a></li>
            <li><a href="/doctor/inventory" class="nav-link px-3 py-2"><i class="bi bi-capsule me-2"></i> Medicine Inventory</a></li>
            <li><a href="/doctor/profile" class="nav-link px-3 py-2"><i class="bi bi-person-circle me-2"></i> My Profile</a></li>
        </ul>
        <div class="mt-auto">
            <hr class="text-white-50">
            <a href="/login?logout=true" class="btn btn-outline-light w-100 rounded-pill fw-bold mt-2">
                <i class="bi bi-box-arrow-right me-2"></i> Log Out
            </a>
        </div>
    </div>

    <div class="flex-grow-1" style="margin-left: 280px;">
        
        <div class="container py-5 px-4" style="max-width: 1000px;">
            
            <div class="d-flex justify-content-between align-items-center mb-4">
                <div>
                    <h2 class="fw-bold text-dark mb-0">
                        <i class="bi bi-person-vcard text-primary me-2"></i>
                        <span th:text="${patient.id == null ? 'Register New Patient' : 'Update Patient Profile'}">Patient Form</span>
                    </h2>
                    <p class="text-muted mt-1 mb-0" th:text="${patient.id == null ? 'Fill in the details below to add a new patient to your roster.' : 'Modify the existing records for this patient.'}"></p>
                </div>
                <a href="/doctor/docdashboard" class="btn btn-light rounded-pill shadow-sm border fw-semibold px-4">
                    <i class="bi bi-arrow-left me-2"></i> Back to Dashboard
                </a>
            </div>

            <div class="card glass-card p-4 p-md-5">
                <form action="/doctor/save-patient" method="POST">
                    
                    <input type="hidden" name="id" th:value="${patient.id}">
                    <input type="hidden" name="patientId" th:value="${patient.patientId}">
                    
                    <h5 class="form-section-title"><i class="bi bi-info-circle me-2"></i> Basic Information</h5>
                    <div class="row g-4 mb-4">
                        <div class="col-md-6">
                            <label class="form-label fw-semibold text-muted small text-uppercase">Full Name *</label>
                            <input type="text" class="form-control form-control-lg bg-light border-0" name="fullName" th:value="${patient.fullName}" required placeholder="e.g., Jane Doe">
                        </div>
                        <div class="col-md-3">
                            <label class="form-label fw-semibold text-muted small text-uppercase">Date of Birth</label>
                            <input type="date" class="form-control form-control-lg bg-light border-0" name="dateOfBirth" th:value="${patient.dateOfBirth}">
                        </div>
                        <div class="col-md-3">
                            <label class="form-label fw-semibold text-muted small text-uppercase">Gender</label>
                            <select class="form-select form-select-lg bg-light border-0" name="gender">
                                <option value="">Select...</option>
                                <option value="Male" th:selected="${patient.gender == 'Male'}">Male</option>
                                <option value="Female" th:selected="${patient.gender == 'Female'}">Female</option>
                                <option value="Other" th:selected="${patient.gender == 'Other'}">Other</option>
                            </select>
                        </div>
                    </div>

                    <h5 class="form-section-title"><i class="bi bi-telephone me-2"></i> Contact Details</h5>
                    <div class="row g-4 mb-4">
                        <div class="col-md-4">
                            <label class="form-label fw-semibold text-muted small text-uppercase">Phone Number *</label>
                            <div class="input-group">
                                <span class="input-group-text bg-light border-0"><i class="bi bi-telephone-fill text-muted"></i></span>
                                <input type="tel" class="form-control form-control-lg bg-light border-0" name="phone" th:value="${patient.phone}" required placeholder="10-digit number">
                            </div>
                        </div>
                        <div class="col-md-4">
                            <label class="form-label fw-semibold text-muted small text-uppercase">Email Address</label>
                            <div class="input-group">
                                <span class="input-group-text bg-light border-0"><i class="bi bi-envelope-fill text-muted"></i></span>
                                <input type="email" class="form-control form-control-lg bg-light border-0" name="emailAddress" th:value="${patient.emailAddress}" placeholder="name@example.com">
                            </div>
                        </div>
                        <div class="col-md-4">
                            <label class="form-label fw-semibold text-muted small text-uppercase">Emergency Contact</label>
                            <input type="text" class="form-control form-control-lg bg-light border-0" name="emergencyContact" th:value="${patient.emergencyContact}" placeholder="Name & Phone">
                        </div>
                        <div class="col-12">
                            <label class="form-label fw-semibold text-muted small text-uppercase">Residential Address</label>
                            <textarea class="form-control bg-light border-0" name="residentialAddress" rows="2" placeholder="Full street address..." th:text="${patient.residentialAddress}"></textarea>
                        </div>
                    </div>

                    <h5 class="form-section-title"><i class="bi bi-clipboard2-pulse me-2"></i> Medical Profile</h5>
                    <div class="row g-4 mb-4">
                        <div class="col-md-2">
                            <label class="form-label fw-semibold text-muted small text-uppercase">Blood Group</label>
                            <select class="form-select form-select-lg bg-light border-0 text-danger fw-bold" name="bloodGroup">
                                <option value="">Unknown</option>
                                <option value="A+" th:selected="${patient.bloodGroup == 'A+'}">A+</option>
                                <option value="A-" th:selected="${patient.bloodGroup == 'A-'}">A-</option>
                                <option value="B+" th:selected="${patient.bloodGroup == 'B+'}">B+</option>
                                <option value="B-" th:selected="${patient.bloodGroup == 'B-'}">B-</option>
                                <option value="O+" th:selected="${patient.bloodGroup == 'O+'}">O+</option>
                                <option value="O-" th:selected="${patient.bloodGroup == 'O-'}">O-</option>
                                <option value="AB+" th:selected="${patient.bloodGroup == 'AB+'}">AB+</option>
                                <option value="AB-" th:selected="${patient.bloodGroup == 'AB-'}">AB-</option>
                            </select>
                        </div>
                        <div class="col-md-2">
                            <label class="form-label fw-semibold text-muted small text-uppercase">Height (cm)</label>
                            <input type="number" class="form-control form-control-lg bg-light border-0" name="height" th:value="${patient.height}" step="0.1" placeholder="e.g. 170">
                        </div>
                        <div class="col-md-2">
                            <label class="form-label fw-semibold text-muted small text-uppercase">Weight (kg)</label>
                            <input type="number" class="form-control form-control-lg bg-light border-0" name="weight" th:value="${patient.weight}" step="0.1" placeholder="e.g. 65">
                        </div>
                        <div class="col-md-6">
                            <label class="form-label fw-semibold text-muted small text-uppercase">Current Condition</label>
                            <select class="form-select form-select-lg bg-light border-0" name="condition">
                                <option value="Stable" th:selected="${patient.condition == 'Stable'}">ðŸŸ¢ Stable</option>
                                <option value="Observation" th:selected="${patient.condition == 'Observation'}">ðŸŸ¡ Under Observation</option>
                                <option value="Recovering" th:selected="${patient.condition == 'Recovering'}">ðŸ”µ Recovering</option>
                                <option value="Critical" th:selected="${patient.condition == 'Critical'}">ðŸ”´ Critical</option>
                            </select>
                        </div>
                        <div class="col-md-6">
                            <label class="form-label fw-semibold text-muted small text-uppercase">Known Allergies</label>
                            <input type="text" class="form-control form-control-lg bg-light border-0" name="allergies" th:value="${patient.allergies}" placeholder="e.g., Peanuts, Penicillin">
                        </div>
                        <div class="col-md-6">
                            <label class="form-label fw-semibold text-muted small text-uppercase">Chronic Diseases</label>
                            <input type="text" class="form-control form-control-lg bg-light border-0" name="chronicDiseases" th:value="${patient.chronicDiseases}" placeholder="e.g., Diabetes, Asthma">
                        </div>
                    </div>

                    <div class="text-end mt-5 pt-4 border-top">
                        <button type="submit" class="btn btn-primary btn-lg rounded-pill px-5 shadow-sm fw-bold">
                            <i class="bi bi-save me-2"></i> <span th:text="${patient.id == null ? 'Complete Registration' : 'Save Changes'}">Save</span>
                        </button>
                    </div>

                </form>
            </div>
        </div>
    </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>